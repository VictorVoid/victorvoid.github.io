<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Aprenda de uma vez o que é o Sharding no MongoDB</title>
  <meta name="description" content="Gosta de JavaScript ? Sim ? Então já podemos ser amigos.">
  <meta name="author" content="Victor Igor">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Victor Igor">
  <meta name="twitter:description" content="Gosta de JavaScript ? Sim ? Então já podemos ser amigos.">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Victor Igor">
  <meta property="og:description" content="Gosta de JavaScript ? Sim ? Então já podemos ser amigos.">

  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/styl.css">
  <link rel="canonical" href="http://victorvoid///sharding-gerenciamento-usuarios/">
  <link rel="alternate" type="application/rss+xml" title="Victor Igor" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Victor Igor">
          <img src="/images/profile.png" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Victor Igor</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Gosta de JavaScript ? Sim ? Então já podemos ser amigos.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Victor Igor blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/victorvoid_" title="@victorvoid_ on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/victorcalangu" title="victorcalangu on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/victorvoid" title="victorvoid on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:victor.0w3@hotmail.com" title="Email victor.0w3@hotmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="9 Feb 2016" class="post-meta__date date">9 Feb 2016</time> &#8226; <span class="post-meta__tags">on <a href="/tags/#mongodb">mongodb</a> </span>
    </div>
    <h1 class="post-title">Aprenda de uma vez o que é o Sharding no MongoDB</h1>
  </header>

  <section class="post">
    <p>Sharding, o porquê do uso dele e como gerenciar usuários.</p>

<p>Eita que demorei um pouco pra postar. =( Acabei me atrasando com algumas coisas, mas então vamos lá, aliás está em época de carnaval. <del>Que mostra claramente o que o brasileiro é, mesmo o país na pior, sempre sorrindo.</del> :D  <br />
Não pera, eu não vou falar sobre carnaval aqui lol, sim, como o título diz, é mongoDB, uma coisa muito mais divertida, não é ?</p>

<p>Então vamos logo entender que diabos é esse <strong>sharding</strong>.</p>

<h1 id="sharding--pra-qu-">Sharding ? Pra quê ?</h1>

<p><img src="/images/o-que-e-meanstack/o-que-e-meanstack.jpg" /></p>

<p>O sharding é aquele processo de armazenar os dados em várias máquinas. Tá, mas pra quê isso ? Simples, lembra que o mongodb joga os dados da collection para a memória RAM, por isso ele é extremamente rápido, porém se os dados dessa collection forem maior que sua RAM, ele vai precisar fazer paginação, e claro isso afeta o desempenho, CONTUDO, entretanto, porém, todaviaaaa o sharding está ae pra resolver.</p>

<p><img src="/images/sharding-gerenciamento-usuarios/happy-scooby.gif" alt="" /></p>

<p>Com ele você joga os dados pra outras máquinas, assim o desempenho não é afetado porque outras máquinas estão ali pra ajudar, é como se fosse os amigo ajudando outro amigo a carregar os sacos de areia.</p>

<figure class="foto-legenda">
	<img src="/images/sharding-gerenciamento-usuarios/ajudando-carregar.jpg" alt="" />
	<figcaption> <p>Os voluntários formam uma corrente humana, pois ajudam carregar sacos de areia. Terça-feira, 29 de dezembro de 2015</p>
	</figcaption>
</figure>

<p>E por esse motivo ele é escalável horizontalmente, diferente de alguns outros bancos que possui escabilidade vertical, e no lugar de ter outro amiguinho ajudando com o peso, o rapaz tenta carregar tudo sozinho, porém com mais força, e pra isso, precisa de mais memória e força de processamento no mesmo servidor.</p>

<p><img src="/images/sharding-gerenciamento-usuarios/carrega-sozinho.jpg" alt="" /></p>

<h2 id="quando-eu-posso-usar-sharding-">Quando eu posso usar sharding ?</h2>

<p>Simples! Por exemplo, quando você perceber que sua coleção está chegando perto da memória que o servidor tem para o MongoDB. Claro, você pode fazer logo o sharding e deixar o servidor preparado para o crescimento. E também, quando o disco local não for grande o suficiente.</p>

<h3 id="ateno">Atenção</h3>

<p>Também não vai querer sair criando sharding pra tudo né lol mas se você tem uma única coleção com grande número de registros(mas imenso mesmo), realmente vai precisar fazer essa fragmentação. <br />
<code class="highlighter-rouge">Escabilidade</code> de certa forma é complexo, mas dê uma lida sobre:</p>

<ol>
  <li><a href="http://dba.stackexchange.com/questions/4508/what-does-horizontal-scaling-mean" target="_blank">What does horizontal scaling mean?</a></li>
  <li><a href="https://blog.openshift.com/best-practices-for-horizontal-application-scaling/" target="_blank">Best Practices For Horizontal Application Scaling</a></li>
  <li><a href="http://www.infoq.com/articles/ebay-scalability-best-practices" target="_blank">Scalability Best Practices: Lessons from eBay</a></li>
  <li><a href="http://stackoverflow.com/questions/5401992/what-does-scale-horizontally-and-scale-vertically-mean" target="_blank">What does scale horizontally and scale vertically mean?</a></li>
</ol>

<h2 id="ta-mas-me-diz-logo-como-usa">Ta mas me diz logo como usa</h2>

<p>Pra isso leia esse artigo do sussu que ele explica: <a href="http://nomadev.com.br/be-mean-mongodb-como-usar-sharding/" target="_blank">Como usar Sharding</a></p>

<p>Lembrando que MongoDB fornece as funções de usuário do banco de dados e administração de banco de dados embutidos em cada banco de dados. Ele fornece todas as outras funções integrado apenas no banco de dados administrador. E para criação de <em>sharding</em>, você precisa ser um <em>admin</em> ou um <em>manager</em>, bem se você ainda não entende como fazer o gerenciamento de usuários, vamos lá aprender, porque é muito importante para a segurança. =)</p>

<h1 id="gerenciamento-de-usurios">Gerenciamento de Usuários</h1>

<p>Você vai precisar ter um gerenciamento dos seus usuários do banco, por exemplo, colocando privilégios que uns tem e outros não, alguns podem modificar e outros apenas monitorar, tudo tem como gerenciar. Toda aquela nossa autenticação e autorização fica na coleção <code class="highlighter-rouge">system.users</code> no banco <code class="highlighter-rouge">admin</code> e você pode gerenciar através do mongo. Aliás se você não sabe a diferença entre autenticação e autorização <del>você está ferrado</del>, eu posso tentar explicar de uma forma bem simples:</p>

<blockquote>
  <p>Sabe quando você coloca senha no seu computador, e ao iniciar ele pede o login e senha ? Então, ao está logando, você está autenticando, e autorização é esse processo de verificação, caso esteja errado você não está autorizado para entrar.</p>
</blockquote>

<h2 id="principais-comandos-para-o-gerenciamento-de-usurios">Principais comandos para o gerenciamento de usuários</h2>

<ul>
  <li><span class="kd-s">createUser</span> - Cria um usuário no banco que estiver.</li>
</ul>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">use</span> <span class="nx">admin</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">createUser</span><span class="p">{</span>
	<span class="nl">user</span><span class="p">:</span> <span class="s2">"bonitao"</span><span class="p">,</span>
	<span class="nx">pwd</span><span class="err">:</span> <span class="s2">"2016bonitao"</span><span class="p">,</span>
	<span class="nx">roles</span><span class="err">:</span> <span class="p">[{</span><span class="na">role</span><span class="p">:</span> <span class="s2">"userAdminAnyDatabase"</span><span class="p">,</span> <span class="na">db</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">}]</span>
<span class="p">}</span></code></pre></figure>

<p>O <code class="highlighter-rouge">role</code> serve para você definir a função do usuário, nesse por exemplo foi para criar um usuário administrador que tem acesso a todos os bancos.</p>

<p>Pra saber como criar e usar as roles para outros tipos de funções acesse:</p>

<p><a href="https://docs.mongodb.org/v2.6/tutorial/add-user-to-database/" target="_blank">Add a User to a Database</a></p>

<p>E depois de criar pode-se querer atualizar um usuário não é?</p>

<ul>
  <li><span class="kd-s">db.updateUser</span> - Atualiza o usuário no banco que estiver.</li>
</ul>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">db</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">(</span><span class="s2">"bonitao"</span><span class="p">,</span>
<span class="p">{</span>
	<span class="na">pwd</span><span class="p">:</span> <span class="s2">"2016bonitao"</span><span class="p">,</span>
	<span class="na">roles</span><span class="p">:</span> <span class="p">[{</span><span class="na">role</span><span class="p">:</span> <span class="s2">"read"</span><span class="p">,</span> <span class="na">db</span><span class="p">:</span> <span class="s2">"assets"</span><span class="p">}]</span>
<span class="p">})</span></code></pre></figure>

<p>Além de atualizar, podemos deletar:</p>

<ul>
  <li><span class="kd-s">db.removeUser</span> - Remove o usuário no banco que estiver</li>
</ul>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">db</span><span class="p">.</span><span class="nx">removeUser</span><span class="p">(</span><span class="s2">"bonitao"</span><span class="p">)</span></code></pre></figure>

<p>Além desses, existe muitos outros que podem ser encontrados <a href="https://docs.mongodb.org/manual/reference/method/js-user-management/" target="_blank">aqui</a>. Se divirta pra testar heueh =D</p>

<p>Depois de criar tudo certinho, precisamos conectar autenticando no mongo:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//1. Reinicie o mongo com:</span>


<span class="nx">mongod</span> <span class="o">--</span><span class="nx">out</span>


<span class="c1">//2. Conecte com o mongo:</span>


<span class="nx">mongo</span> <span class="o">--</span><span class="nx">port</span> <span class="mi">27017</span> <span class="o">-</span><span class="nx">u</span> <span class="s2">"bonitao"</span> <span class="o">-</span><span class="nx">p</span> <span class="s2">"2016bonitao"</span> <span class="o">--</span> <span class="nx">authenticationDatabase</span> <span class="s2">"admin"</span>


<span class="c1">//3. Se derrepente já se conectou sem usuário e queria autenticar, execute:</span>


<span class="nx">db</span><span class="p">.</span><span class="nx">auth</span><span class="p">(</span><span class="s2">"bonitao"</span><span class="p">,</span><span class="s2">"2016bonitao"</span><span class="p">)</span></code></pre></figure>

<p>LOOOL Agora você sabe o que é sharding, como usar e como gerenciar usuários!!!</p>

<p><img src="/images/sharding-gerenciamento-usuarios/daca-animada.gif" alt="" /></p>

<h2 id="concluindo">Concluindo</h2>

<p>Pro último post dessa série ficar legal, vou trazer uma modelagem e quem sabe um projeto, pra praticar todos esses conhecimentos adquiridos até aqui. =)</p>

<p>Então é isso, beijoca e até a próxima.</p>

<p><img src="/images/mongodb123/bye.gif" /></p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'victorvoid'; // required: replace example with your forum shortname
        var disqus_config = function () {
          this.page.url = 'http://victorvoid//sharding-gerenciamento-usuarios/';
          this.page.identifier = '/sharding-gerenciamento-usuarios';
          this.page.title = 'Aprenda de uma vez o que é o Sharding no MongoDB';
        };
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Victor Igor. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

    </div>
  </body>
</html>