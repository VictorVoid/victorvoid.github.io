<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Como atualizar e remover no MongoDB ?</title>
  <meta name="description" content="Gosta de JavaScript ? Sim ? Então já podemos ser amigos.">
  <meta name="author" content="Victor Igor">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@">
  <meta name="twitter:title" content="Como atualizar e remover no MongoDB ?">
  <meta name="twitter:description" content="Atualizando e removendo objetos, operadores de array, operadores de buscas em arrays e operadores de negação.">

 <!-- Social: Facebook / Open Graph -->
  <meta property="og:url" content="http://victorvoid///mongodb-aula4/">
  <meta property="og:title" content="Como atualizar e remover no MongoDB ?">
  <meta property="og:description" content="Atualizando e removendo objetos, operadores de array, operadores de buscas em arrays e operadores de negação.">
  <meta property="og:site_name" content="Victor Igor">

  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/styl.css">
  <link rel="canonical" href="http://victorvoid///mongodb-aula4/">
  <link rel="alternate" type="application/rss+xml" title="Victor Igor" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Victor Igor">
          <img src="/images/profile.png" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Victor Igor</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Gosta de JavaScript ? Sim ? Então já podemos ser amigos.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Victor Igor blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/victorvoid_" title="@victorvoid_ on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/victorcalangu" title="victorcalangu on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/victorvoid" title="victorvoid on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:victor.0w3@hotmail.com" title="Email victor.0w3@hotmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="25 Dec 2015" class="post-meta__date date">25 Dec 2015</time> &#8226; <span class="post-meta__tags">on <a href="/tags/#mongodb">mongodb</a> </span>
    </div>
    <h1 class="post-title">Como atualizar e remover no MongoDB ?</h1>
  </header>

  <section class="post">
    <p>Atualizando e removendo objetos, operadores de array, operadores de buscas em arrays e operadores de negação.</p>

<h1 id="atualizando-e-removendo-dados">Atualizando e Removendo dados</h1>

<p><img src="/assets/img/mongodb-update/digitando-rapido.gif" /></p>

<p><del>Agora o bicho vai pegar LOL.</del></p>

<h2 id="update">UPDATE</h2>

<p>No MongoDB não existe só uma forma de atualizar o documento, uma das formas já vimos <a href="http://victorvoid.github.io/2015/12/07/mongodb-aula-1-2-3-be-mean.html">neste post</a>, que foi fazendo uma busca usando o <span class="nf-s">findOne( )</span>, e através do resultado modificamos e usamos a função <span class="nf-s">save( )</span>, porém esse caminho é grande, perceba que precisamos fazer a busca, salvar na variável, e modificar para depois salvar.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s1">'Carterpie'</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">p</span>     <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">name</span>    <span class="o">=</span> <span class="s1">'RatoCabeludo'</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span></code></pre></figure>

<h3 id="qual-a-melhor-forma">Qual a melhor forma?</h3>

<p>Ele possui uma função chamada <span class="nf-s">update( )</span> que tem esse objetivo de fazer tudo de uma só vez. Contém 3 parâmetros que veremos com mais detalhe cada um.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">colecao</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">modificador</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></code></pre></figure>

<blockquote class="trivia">
<p><strong class="cabecalho">Info 1</strong>
O parâmetro <span class="kd-s">options</span> não é obrigatório.</p>
</blockquote>
<p>Vamos inserir um objeto para modificarmos</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">poke</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s2">"Testemon"</span><span class="p">,</span> <span class="na">attack</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>
        <span class="na">defense</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="mf">2.1</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="s2">"Pokemon de teste"</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">poke</span><span class="p">);</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/testemon/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">);</span></code></pre></figure>

<blockquote class="trivia">
<p><strong class="cabecalho">Info 2</strong>
Na variável <span class="kd-s">query</span> passamos o name, porém usamos a barra entre o nome, isso é uma <strong>REGEX</strong>, o <strong>i</strong> informa que não importa se é maiúsculo ou minúsculo. Assim fazendo uma busca Case insensitive</p>
</blockquote>
<p>Me retornou:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Testemon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defense"</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pokemon de teste"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="vamos-modificar-o-testemon">Vamos modificar o Testemon</h2>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/testemon/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>   <span class="o">=</span> <span class="p">{</span><span class="na">description</span><span class="p">:</span> <span class="s2">"Mudei aqui"</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span></code></pre></figure>

<p>Agora agora faça uma busca</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">);</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mudei aqui"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="u-cad-meus-outros-campos-">Ué cadê meus outros campos ?</h2>
<p><img src="/assets/img/mongodb-update/i-have-no-idea.gif" /></p>

<p>hahaha fiz de propósito, essa forma é incorreta, para isso precisamos saber alguns operadores de modificação. <del>Concerte a merda </del>Adicione os valores de volta para continuarmos.</p>

<h2 id="operadores-de-modificao">Operadores de modificação</h2>

<p><strong>$set</strong>: modifica um valor caso já exista, caso não exista, o $set irá criar o campo com esse valor que está alterando.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$set</span><span class="p">:</span>
         <span class="p">{</span>
           <span class="na">name</span><span class="p">:</span><span class="s1">'Testemon'</span><span class="p">,</span> <span class="na">attack</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>
           <span class="na">defense</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="mf">2.1</span><span class="p">,</span>
           <span class="na">description</span><span class="p">:</span> <span class="s2">"Pokemon de teste"</span>
         <span class="p">}</span>
     <span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span></code></pre></figure>

<p><strong>$unset</strong>: remove campos.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$unset</span><span class="p">:</span> <span class="p">{</span><span class="na">height</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="nx">mod</span><span class="p">)</span></code></pre></figure>

<blockquote class="trivia">
<p><strong class="cabecalho">Info 3</strong>
Informe 1 (<span class="nf-s">true</span>) nos campos desejável, assim removendo o campo.</p>
</blockquote>

<p><strong>$inc</strong>: para incrementar um valor e caso o campo não exista, ele irá criar o campo e setar o valor, e para decrementar, passe o valor negativo.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$inc</span><span class="p">:{</span><span class="na">attack</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
 <span class="c1">//-1 para decrementar</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="nx">mod</span><span class="p">)</span></code></pre></figure>

<p>Nos documentos também temos arrays, e se agora queremos também trabalhar com eles, precisamos saber os seus operadores.</p>

<h2 id="operadores-de-array">Operadores de Array</h2>

<p><strong>$push</strong>: ele adiciona um valor ao campo do array caso ele já esteja no documento, e caso não exista esse array, ele irá criar esse campo do tipo array que está passando.
<em>Caso o campo não existe e não for um array, irá retornar um erro.</em></p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'choque de trovão'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pokemon de teste"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Testemon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="mi">8001</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defense"</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"choque de trovão"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>$pushAll</strong>: se utiliza quando queremos passar mais de um valor para um array.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/pokemon de teste/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">attacks</span> <span class="o">=</span><span class="p">[</span>
                 <span class="s1">'choque do trovão'</span><span class="p">,</span>
                 <span class="s1">'ataque rapido'</span><span class="p">,</span>
                 <span class="s1">'bola elétrica'</span>
               <span class="p">]</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$pushAll</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="nx">attacks</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pokemon de teste"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Testemon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="mi">8001</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defense"</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"choque de trovão"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ataque rapido"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bola elétrica"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>$pull</strong>: retira o valor do campo, caso o campo seja um array existente. Caso não exista ele não fará nada, e se o campo existir e não for array, ocorre em um erro.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$pull</span><span class="p">:{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'bola elétrica'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="nx">mod</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pokemon de teste"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Testemon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="mi">8001</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defense"</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"choque do trovão"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ataque rapido"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>$pullAll</strong>: inverso do <strong>$pushAll</strong>, retira todos os valores passado por um array.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">attacks</span> <span class="o">=</span> <span class="p">[</span>
               <span class="s2">"choque do trovão"</span><span class="p">,</span>
               <span class="s2">"ataque rapido"</span>
                <span class="p">]</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="p">{</span><span class="na">$pullAll</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="nx">attacks</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="nx">mod</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">"choque do trovão"</span><span class="p">,</span>
    <span class="s2">"ataque rapido"</span>
  <span class="s2">"_id"</span><span class="err">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">"5665171cd394bd50ba306acd"</span><span class="p">),</span>
  <span class="s2">"description"</span><span class="err">:</span> <span class="s2">"Pokemon de teste"</span><span class="p">,</span>
  <span class="s2">"name"</span><span class="err">:</span> <span class="s2">"Testemon"</span><span class="p">,</span>
  <span class="s2">"attack"</span><span class="err">:</span> <span class="mi">8001</span><span class="p">,</span>
  <span class="s2">"defense"</span><span class="err">:</span> <span class="mi">8000</span><span class="p">,</span>
  <span class="s2">"moves"</span><span class="err">:</span> <span class="p">[</span>
    <span class="s2">"choque de trovão"</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<h3 id="parmetro-options-do-update">Parâmetro OPTIONS do UPDATE</h3>

<p>Lembra daquele último parâmetro que falei que não era obrigatório ?</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">colecao</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">modificador</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></code></pre></figure>

<h2 id="options">OPTIONS</h2>

<h4 id="para-que-ele-serve-">Para que ele serve ?</h4>

<p>Simples, para configurar alguns valores diferentes do padrão em nosso <em>update</em>.
Possui os seguintes parâmetros:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="err">upsert:</span><span class="w">       </span><span class="err">boolean</span><span class="w">
  </span><span class="err">multi:</span><span class="w">        </span><span class="err">boolean</span><span class="w">
  </span><span class="err">writeConcern:</span><span class="w"> </span><span class="err">document</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="upsert">upsert</h2>

<p>Lembra de quando fazemos a busca e colocamos no parâmetro de modificação o valor a ser modificado ? Caso a query não seja encontrada, ele <strong>NÃO</strong> fará nada, e retornará para você:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">WriteResult</span><span class="p">({</span>
  <span class="s2">"nMatched"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"nUpserted"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"nModified"</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">})</span></code></pre></figure>

<p>Tem como modificar esse comportamento ? Sim, o <strong>upsert</strong> serve justamente para isso, por padrão o valor dele é <span class="err-s">false</span>, com isso não fará nada, mas se modificar para <span class="nf-s">true</span>, ele insere o objeto que está sendo passado como modificação.<br />
Vamos ao seguinte exemplo, modificando o valor do ‘upsert’:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span>   <span class="o">=</span> <span class="p">{</span><span class="na">name</span> <span class="p">:</span> <span class="s1">'esse campo nao existe'</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>     <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'campo de fogo'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="na">upsert</span><span class="p">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">WriteResult</span><span class="p">({</span>
  <span class="s2">"nMatched"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">//não encontrou</span>
  <span class="s2">"nUpserted"</span><span class="p">:</span> <span class="mi">1</span> <span class="c1">//porém fez um upsert</span>
  <span class="s2">"nModified"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">"567df96b8c9d5a59c75d1501"</span><span class="p">)</span>
  <span class="c1">//objeto que foi inserido</span>
<span class="p">})</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"567df96b8c9d5a59c75d1501"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"esse campo nao existe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"choque de fogo"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Percebeu que ele criou um novo documento ? =) <br />
<br />
<strong>$setOnInsert</strong>: serve para que podemos colocar um documento que seja inserido caso o upsert seja true e aconteça essa inserção. <br />
Vamos fazer um exemplo que seta os valores comuns para nosso objeto caso ele não seja encontrado no nosso update.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span><span class="o">=</span> <span class="p">{</span><span class="na">name</span> <span class="p">:</span> <span class="s1">'naoexiste'</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>  <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span>
                <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'campo de água'</span><span class="p">},</span>
                <span class="na">$setOnInsert</span><span class="p">:{</span>
                 <span class="na">attack</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                 <span class="na">defense</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                 <span class="na">height</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                 <span class="na">description</span><span class="p">:</span> <span class="s2">"Sem informações"</span>
                <span class="p">}</span>
             <span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="na">upsert</span><span class="p">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">WriteResult</span><span class="p">({</span>
  <span class="s2">"nMatched"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"nUpserted"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">"nModified"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">"567dffac8c9d5a59c75d1502"</span><span class="p">)</span>
<span class="p">})</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<p><span class="c1-s">Repare que agora ele fez uma inserção, pois não foi encontrada a query.</span></p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"567dffac8c9d5a59c75d1502"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"naoexiste"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"campo de água"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defense"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sem maiores informações"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="multi">MULTI</h2>

<p>Lembra daqueles updates sem <strong>WHERE</strong> no banco relacional ? <del>só faltava quebrar tudo pela frente:p</del>
lá precisamos usar o <strong>where</strong> para informar quais os objetos que você quer atualizar, caso contrário <del>nem queira saber</del> ☹ vai atualizar todos. <br />
O MongoDB não deixa acontecer esse tipo de <del>cagada</del> situação. (✌╰_╯)☞ <br />
Por padrão ele só deixa alterar um de cada vez, a não ser que você passe por parâmetro desse multi como <span class="nf-s">true</span>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span>   <span class="o">=</span> <span class="p">{}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>     <span class="o">=</span> <span class="p">{</span><span class="na">$set</span><span class="p">:{</span><span class="na">active</span><span class="p">:</span> <span class="kc">false</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="na">multi</span><span class="p">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<p>Agora se você for verificar, vai ver que todos os documentos estão com uma active <span class="err-s">false</span>. Só assim você consegue fazer um update em vários documentos, alterando seu campo <strong>multi</strong>.</p>

<h2 id="writeconcern">WRITECONCERN</h2>

<p>Ele descreve a garantia de que o MongoDB fornece ao relatar o sucesso de uma operação de escrita. Se você quer isso rápido, ele pode ter uma preocupação fraca, cajo queira uma preocupação forte, ele retorna mais demorado. Porém com a preocupação mais fraca, pode ocorrer de não persistir os dados, e não vai saber sobre aquele erro que pode ter acontecido após alguma coisa, agora com a preocupação mais demorada, ele espera o MongoDB confirmar a alteração de escrita pra você, então a garantia é maior.
Mais sobre o assunto: <a href="https://docs.mongodb.org/v3.0/reference/write-concern/">Clique aqui</a></p>

<h2 id="buscas-em-arrays-">Buscas em arrays ?</h2>

<p>Agora vamos aprimorar nossas buscas, aprendendo fazer buscas em arrays, mas para isso vamos inserir arrays em todos os nossos objetos. (Opa em todos ? Já sabemos fazer isso.)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span>   <span class="o">=</span> <span class="p">{}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>     <span class="o">=</span> <span class="p">{</span><span class="na">$set</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:[</span><span class="s1">'investida'</span><span class="p">]}}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="na">multi</span><span class="p">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">WriteResult</span><span class="p">({</span>
  <span class="s2">"nMatched"</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
  <span class="s2">"nUpserted"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">"nModified"</span><span class="p">:</span> <span class="mi">11</span>
<span class="p">})</span></code></pre></figure>

<p>Vamos inserir mais dados nos arrays para depois fazermos buscas:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/Arcanine/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>   <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'veloz demais'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/Psyduck/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>   <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'lança chamas'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/Metapod/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">mod</span>   <span class="o">=</span> <span class="p">{</span><span class="na">$push</span><span class="p">:</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="s1">'folha navalha'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span></code></pre></figure>

<p>Pronto! Agora já temos arrays em nossos objetos.</p>

<h3 id="operadores-de-buscas-em-arrays">Operadores de buscas em arrays:</h3>

<p><strong>$in</strong>: ele retorna todos os documentos que tem no seu determinado array o valor passado por parâmetro, caso queira especificar mais valores do array, use apenas uma virgula para informar outro valor.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="p">{</span><span class="na">$in</span><span class="p">:</span> <span class="p">[</span><span class="sr">/veloz demais/i</span><span class="p">]}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"564da193ab81d6513c255cac"</span><span class="err">)</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Arcanine"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Arcanine is known for its high speed."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fire"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"attack"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
  </span><span class="nt">"defence"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
  </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.9</span><span class="p">,</span><span class="w">
  </span><span class="nt">"moves"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"investida"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"veloz demais"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>$nin</strong>: É o inverso do $in, e retorna os objetos que não tiverem no valor passado no array.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="p">{</span><span class="na">$nin</span><span class="p">:</span> <span class="p">[</span><span class="sr">/folha navalha"/i</span><span class="p">]}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<p>Vai retornar todos os objetos que não tem no seu array moves o valor ‘folha navalha’.</p>

<p><strong>$all</strong>: Ele é semelhante o <strong>$and</strong>, pois só vai retornar se todos os valores passado por parâmetro do array se forem encontrado no objeto.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">moves</span><span class="p">:</span> <span class="p">{</span><span class="na">$all</span><span class="p">:</span>
                            <span class="p">[</span>
                            <span class="s1">'folha navalha'</span><span class="p">,</span>
                            <span class="s1">'investida'</span>
                            <span class="p">]</span>
                       <span class="p">}</span>
               <span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<h2 id="operadores-de-negao">Operadores de Negação</h2>

<p><strong>$ne</strong>(not equal): ele nos ajuda a procurar todos os objetos que não tempo determinado valor.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">type</span><span class="p">:</span> <span class="p">{</span><span class="na">$ne</span><span class="p">:</span> <span class="s1">'grama'</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<p>E então vai retornar os diversos objetos que não tem o tipo grama. Bem simples. =)</p>
<blockquote class="trivia">
<p><strong class="cabecalho">Info 4</strong>
<span class="err-s">Cuidado</span> ele não aceita <strong>REGEX</strong>. Você não pode passar uma regex usando esse operador, ocorrerá em um erro.
</p>
</blockquote>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">type</span><span class="p">:</span> <span class="p">{</span><span class="na">$ne</span><span class="p">:</span> <span class="sr">/grama/i</span><span class="p">}}</span> <span class="c1">//&lt;--JAMAIS FAÇA ISSO LOL</span></code></pre></figure>

<p><strong>$not</strong>: retorna todos os objetos que não tenha determinada <del>coisa</del> atribuição.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="p">{</span><span class="na">$not</span><span class="p">:</span><span class="sr">/Golbat/i</span><span class="p">}}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<h2 id="remove">REMOVE</h2>

<p>É simples, para removermos um documento, utilizaremos a função <span class="nf-s">remove( )</span> que é própria para isso, e de resto você já sabe, utilize os diversos modos de criar uma query para achar os documentos que queira excluir.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="sr">/Golbat/i</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">pokemons</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span></code></pre></figure>

<blockquote class="trivia">
<p><strong class="cabecalho">Info 5</strong>
<span class="err-s">Cuidado</span> ele é multi <span class="nf-s">true</span>.
</p>
</blockquote>

<p>Se você der um remove sem nada na query, ele apagará tudo. =(<br />
<del>Cuidado para não fazer merda!!!</del> ٩(-̮̮̃-̃)۶</p>

<h2 id="concluindo">Concluindo</h2>

<p>E é isso, agora se divirta treinando modificando seus dados usando todos os operadores, tenta criar atualizações de vários dados simultâneos com javascript, abuse dos laços de repetições e condições, até a próxima, bye!</p>

<p><img src="/assets/img/mongodb123/bye.gif" /></p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'victorvoid'; // required: replace example with your forum shortname
        var disqus_config = function () {
          this.page.url = 'http://victorvoid//mongodb-aula4/';
          this.page.identifier = '/mongodb-aula4';
          this.page.title = 'Como atualizar e remover no MongoDB ?';
        };
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Victor Igor. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

    </div>
  </body>
</html>